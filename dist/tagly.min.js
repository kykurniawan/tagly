!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tagly=e():t.Tagly=e()}(self,(()=>(()=>{var t={138:(t,e,i)=>{const s=i(316).Z;t.exports=s},316:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});const s=[{item:"name",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"value",type:"Array",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"placeholder",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"clearDefaultStyles",type:"Boolean",validate:t=>"[object Boolean]"==Object.prototype.toString.call(t)},{item:"displayError",type:"Boolean",validate:t=>"[object Boolean]"==Object.prototype.toString.call(t)},{item:"itemCase",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"sendAsJSON",type:"Boolean",validate:t=>"[object Boolean]"==Object.prototype.toString.call(t)},{item:"wrapperStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"wrapperClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"previewStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"previewClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"inputStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"inputClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"errorStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"errorClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"previewItemStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"previewItemClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"deleteItemButtonHTML",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"deleteItemButtonStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"deleteItemButtonClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"autocomplete",type:"Boolean",validate:t=>"[object Boolean]"==Object.prototype.toString.call(t)},{item:"autocompleteItems",type:"Array",validate:t=>"[object Array]"==Object.prototype.toString.call(t)},{item:"autocompleteWrapperStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"autocompleteWrapperClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"autocompleteContainerStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"autocompleteContainerClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"autocompleteItemStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"autocompleteItemClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"autocompleteLoaderHTML",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"autocompleteLoaderStyles",type:"Object",validate:t=>"[object Object]"==Object.prototype.toString.call(t)},{item:"autocompleteLoaderClasses",type:"String",validate:t=>"[object String]"==Object.prototype.toString.call(t)},{item:"tagValidation",type:"Function",validate:t=>"[object Function]"==Object.prototype.toString.call(t)},{item:"createWrapper",type:"Function",validate:t=>"[object Function]"==Object.prototype.toString.call(t)}],a=class extends EventTarget{constructor(t,e={}){super(),this._values=[],this._autocompleteItems=[],this._autocompleteReady=!0,this._error="",this._liveInputValue="",this._typing=!1,this._validateElement(t),this._validateConfig(e),this._initConfig(e),this._createElements(),this._setInitValue(),this._configureListener()}_validateElement(t){if(!t)throw new Error("Tagly initialization requires at least one parameter as input element tag");if(!t.hasAttribute("id")||""==t.id)throw new Error("Tagly element must have an id");this._element=t,this._id=this._element.id}_validateConfig(t){Object.entries(t).forEach((([t,e])=>{if(0==s.map((t=>t.item)).includes(t))throw new Error(t+": is not a valid Tagly config item");const i=s.filter((e=>e.item==t))[0];if(0==i.validate(e))throw new Error(t+": only accepts "+i.type)}))}_initConfig(t){null==t.clearDefaultStyles&&(t.clearDefaultStyles=!1),null==t.displayError&&(t.displayError=!0),null==t.itemCase&&(t.itemCase="capitalize"),null==t.sendAsJSON&&(t.sendAsJSON=!1),null==t.autocomplete&&(t.autocomplete=!1),null!=t.autocompleteItems&&(this._autocompleteItems=t.autocompleteItems),this._config=t}_createElements(){const t=document.createElement("div");this._setWrapperStyle(t),this._setWrapperClass(t),t.setAttribute("id",this._id+"__wrapper");const e=document.createElement("div");e.setAttribute("id",this._id+"__error-message");const i=document.createElement("span");this._setPreviewStyle(i),this._setPreviewClass(i),i.setAttribute("id",this._id+"__preview");const s=document.createElement("input");this._setInputStyle(s),this._setInputClass(s),s.setAttribute("id",this._id+"__input"),s.setAttribute("autocomplete","off"),null!=this._config.placeholder?s.placeholder=this._config.placeholder:s.placeholder="Type then enter..";const a=document.createElement("input");a.setAttribute("id",this._id+"__value"),a.setAttribute("type","hidden"),null!=this._config.name&&""!=this._config.name?a.setAttribute("name",this._config.name):a.setAttribute("name",this._id+"__value");const o=document.createElement("div");o.setAttribute("id",this._id+"__autocomplete-wrapper");const l=document.createElement("div");l.setAttribute("id",this._id+"__autocomplete-container"),this._wrapper=t,this._errorMessage=e,this._preview=i,this._input=s,this._hiddenInput=a,this._autocompleteWrapper=o,this._autocompleteContainer=l,this._element.append(this._errorMessage),this._element.append(this._wrapper),this._config.autocomplete&&(this._element.append(this._autocompleteWrapper),this._autocompleteWrapper.append(this._autocompleteContainer)),this._wrapper.append(this._preview),this._wrapper.append(this._input),this._wrapper.append(this._hiddenInput)}_setInitValue(){if(null!=this._config.value)this._setValues(this._sanitizeRawValue(this._config.value));else if(this._element.hasAttribute("data-value")){const t=this._element.getAttribute("data-value");this._setValues(this._sanitizeRawValue(t))}}_configureListener(){let t;this._element.addEventListener("click",(t=>{this._input.focus()})),this._input.addEventListener("keydown",(t=>{if("Backspace"==t.key&&""==t.target.value&&this._values.length>0){let t=this._values[this._values.length-1];this._removeValue(t.id)}this._clearError()})),this._input.addEventListener("keypress",(t=>{if("Enter"==t.key){t.preventDefault();let e=this._sanitizeTag(t.target.value);""!=e&&this._addValue(this._createValueObject(e)),t.target.value="",this._resetAutocomplete()}})),this._input.addEventListener("keyup",(t=>{if(""!=t.target.value&&","==t.target.value.charAt(t.target.value.length-1)){let e=this._sanitizeTag(t.target.value.slice(0,-1));""!=e&&this._addValue(this._createValueObject(e)),t.target.value="",this._resetAutocomplete()}})),this._input.addEventListener("paste",(t=>{t.preventDefault();let e=this._sanitizeRawValue(t.clipboardData.getData("Text"));this._addMultiple(e),this._triggerEvent("paste",e),this._resetAutocomplete()})),this._input.addEventListener("input",(e=>{this._autocompleteReady=!0,this._liveInputValue=e.target.value,this._config.autocomplete&&this._showAutocompleteLoader(),this._triggerEvent("input",e.target.value),0==this._typing&&(this._triggerEvent("typing",{}),this._typing=!0),clearTimeout(t),t=setTimeout((()=>{this._triggerEvent("done-typing",{autocomplete:this._autocomplete()}),this._autocompleteReady&&this._showAutocomplete(e.target.value),this._typing=!1}),300,e)}))}_createValueObject(t){return{id:this._uniqueId(),tag:t}}_setError(t){if(this._config.displayError){let e=document.createElement("span");e.textContent=t,this._setErrorStyle(e),this._setErrorClass(e),this._errorMessage.append(e)}this._triggerEvent("error",t)}_clearError(){this._errorMessage.innerHTML=""}_setValues(t){this._values=t,this._updatePreview(),this._updateHiddenInputValue()}_addFromRaw(t){let e=this._sanitizeRawValue(t);this._addMultiple(e)}_addValue(t){this._isNotDuplicate(t)&&(this._values.push(t),this._updatePreview(),this._updateHiddenInputValue(),this._triggerEvent("added",t),this._triggerEvent("changed",this._values))}_addMultiple(t){t.forEach((t=>{this._isNotDuplicate(t)&&this._values.push(t)})),this._updatePreview(),this._updateHiddenInputValue(),this._triggerEvent("changed",this._values)}_isNotDuplicate(t){return this._values.filter((e=>e.tag==t.tag)).length<1||(this._triggerEvent("duplicate",t),!1)}_removeValue(t){const e=this._values.filter((e=>e.id===t))[0];this._values=this._values.filter((e=>e.id!==t)),this._updatePreview(),this._updateHiddenInputValue(),this._triggerEvent("removed",e),this._triggerEvent("changed",this._values)}_updatePreview(){this._preview.innerHTML="",this._values.forEach((t=>{let e=t.id,i=t.tag,s=t.tag,a=this._createPreviewItem(e,i,s);this._preview.append(a)}))}_updateHiddenInputValue(){this._config.sendAsJSON?this._hiddenInput.value=JSON.stringify(this._values):this._hiddenInput.value=this._values.map((t=>t.tag)).join(",")}_sanitizeRawValue(t){let e=[];return t.split(",").forEach((t=>{if(""!=(t=this._sanitizeTag(t))){const i=t;e.filter((t=>t.tag==i)).length<1&&e.push(this._createValueObject(i))}})),e}_sanitizeTag(t,e=!0){return t=t.trim(),t="capitalize"==this._config.itemCase?t.replace(/(^\w|\s\w)/g,(t=>t.toUpperCase())):"uppercase"==this._config.itemCase?t.toUpperCase():"lowercase"==this._config.itemCase?t.toLowerCase():t.replace(/(^\w|\s\w)/g,(t=>t.toUpperCase())),e&&0==this._isValidTag(t)&&(t=""),t}_isValidTag(t){if(null!=this._config.tagValidation){const e=this._config.tagValidation(t);return this._validateTagValidationReturnValue(e),e}return this._clearError(),!0}_validateTagValidationReturnValue(t){if("[object Boolean]"!=Object.prototype.toString.call(t))throw new Error("The validation must return true or false according to your validation results.")}_createPreviewItem(t,e,i){let s=document.createElement("button");s.tabIndex="-1",s.innerHTML="&#10007;",null!=this._config.deleteItemButtonHTML&&""!=this._config.deleteItemButtonHTML&&(s.innerHTML=this._config.deleteItemButtonHTML),this._setDeleteItemButtonStyle(s),this._setDeleteItemButtonClass(s),s.addEventListener("click",(t=>{this._removeValue(t.target.parentElement.id)}));let a=document.createElement("span");return this._setPreviewItemStyle(a),this._setPreviewItemClass(a),a.setAttribute("id",t),a.setAttribute("data-tag",e),a.append(s),a.append(i),a}_uniqueId(){return Math.random().toString(36).replace(".","")}_triggerEvent(t,e){switch(t){case"changed":this.dispatchEvent(new CustomEvent("changed",{detail:e}));break;case"added":this.dispatchEvent(new CustomEvent("added",{detail:e}));break;case"removed":this.dispatchEvent(new CustomEvent("removed",{detail:e}));break;case"error":this.dispatchEvent(new CustomEvent("error",{detail:e}));break;case"paste":this.dispatchEvent(new CustomEvent("paste",{detail:e}));break;case"duplicate":this.dispatchEvent(new CustomEvent("duplicate",{detail:e}));break;case"input":this.dispatchEvent(new CustomEvent("input",{detail:e}));break;case"typing":this.dispatchEvent(new CustomEvent("typing",{detail:e}));break;case"done-typing":this.dispatchEvent(new CustomEvent("done-typing",{detail:e}))}}_autocomplete(){return{active:this._config.autocomplete,search:this._liveInputValue,pause:()=>{if(0==this._config.autocomplete)return!1;this._autocompleteReady=!1},continue:(t=null)=>{if(0==this._config.autocomplete)return!1;if("[object Array]"!=Object.prototype.toString.call(t)&&null!=t)throw new Error("continue function only accept array of autocomplete items");null!=t&&t.length>0&&(this._autocompleteItems=t),this._showAutocomplete(this._liveInputValue)}}}_resetAutocomplete(){0!=this._config.autocomplete&&(this._autocompleteWrapper.removeAttribute("style"),this._autocompleteWrapper.removeAttribute("class"),this._autocompleteWrapper.querySelector(`#${this._id}__autocomplete-container`).removeAttribute("style"),this._autocompleteWrapper.querySelector(`#${this._id}__autocomplete-container`).removeAttribute("class"),this._autocompleteWrapper.querySelector(`#${this._id}__autocomplete-container`).innerHTML="")}_showAutocomplete(t){if(0==this._config.autocomplete)return!1;this._resetAutocomplete(),this._hideAutocompleteLoader();const e=this._autocompleteWrapper,i=this._autocompleteContainer,s=this._autocompleteItems;if(!t)return!1;for(let a=0;a<s.length;a++){const o=this._regexSearch(s[a],t);if(""!=o){this._setAutocompleteContainerStyle(i),this._setAutocompleteContainerClass(i),this._setAutocompleteWrapperStyle(e),this._setAutocompleteWrapperClass(e);const t=document.createElement("span");this._setAutocompleteItemStyle(t),this._setAutocompleteItemClass(t),t.setAttribute("data-value",s[a]),t.setAttribute("role","button"),t.innerHTML=o,t.addEventListener("click",(e=>{const i=t.getAttribute("data-value"),s=this._sanitizeTag(i);""!=s&&this._addValue(this._createValueObject(s)),this._resetAutocomplete(),this._input.value=""})),0==this._values.map((t=>t.tag)).includes(this._sanitizeTag(t.getAttribute("data-value"),!1))&&i.appendChild(t)}}}_regexSearch(t,e){try{const i=new RegExp(e,"i"),s=t.match(i);if(null==s)return"";const a=s[0],o=s.index,l=s.input;return l.substr(0,o)+"<strong>"+a+"</strong>"+l.substr(o+a.length)}catch(t){return""}}_setWrapperStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.border="1px solid black",t.style.cursor="text",t.style.display="flex",t.style.flexWrap="wrap",t.style.alignItems="center"),null!=this._config.wrapperStyles)for(const[e,i]of Object.entries(this._config.wrapperStyles))t.style[e]=i}_setWrapperClass(t){null!=this._config.wrapperClasses&&t.setAttribute("class",this._config.wrapperClasses)}_setErrorStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.marginBottom="5px",t.style.display="inline-block",t.style.color="red"),null!=this._config.errorStyles)for(const[e,i]of Object.entries(this._config.errorStyles))t.style[e]=i}_setErrorClass(t){null!=this._config.errorClasses&&t.setAttribute("class",this._config.errorClasses)}_setPreviewStyle(t){if(null!=this._config.previewStyles)for(const[e,i]of Object.entries(this._config.previewStyles))t.style[e]=i}_setPreviewClass(t){null!=this._config.previewClasses&&t.setAttribute("class",this._config.previewClasses)}_setPreviewItemStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.boxSizing="border-box",t.style.padding="5px",t.style.margin="5px",t.style.display="inline-block",t.style.backgroundColor="rgb(239, 239, 239)"),null!=this._config.previewItemStyles)for(const[e,i]of Object.entries(this._config.previewItemStyles))t.style[e]=i}_setPreviewItemClass(t){null!=this._config.previewItemClasses&&t.setAttribute("class",this._config.previewItemClasses)}_setDeleteItemButtonStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.cursor="pointer",t.style.marginRight="10px",t.style.padding="0",t.style.border="none",t.style.background="transparent"),null!=this._config.deleteItemButtonStyles)for(const[e,i]of Object.entries(this._config.deleteItemButtonStyles))t.style[e]=i}_setDeleteItemButtonClass(t){null!=this._config.deleteItemButtonClasses&&t.setAttribute("class",this._config.deleteItemButtonClasses)}_setInputStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.border="none",t.style.outline="none",t.style.boxSizing="border-box",t.style.flexGrow="1",t.style.padding="5px"),null!=this._config.inputStyles)for(const[e,i]of Object.entries(this._config.inputStyles))t.style[e]=i}_setInputClass(t){null!=this._config.inputClasses&&t.setAttribute("class",this._config.inputClasses)}_setAutocompleteWrapperStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.position="absolute",t.style.backgroundColor="#f6f6f6"),null!=this._config.autocompleteWrapperStyles)for(const[e,i]of Object.entries(this._config.autocompleteWrapperStyles))t.style[e]=i}_setAutocompleteWrapperClass(t){null!=this._config.autocompleteWrapperClasses&&t.setAttribute("class",this._config.autocompleteWrapperClasses)}_setAutocompleteContainerStyle(t){if(null!=this._config.autocompleteContainerStyles)for(const[e,i]of Object.entries(this._config.autocompleteContainerStyles))t.style[e]=i}_setAutocompleteContainerClass(t){null!=this._config.autocompleteContainerClasses&&t.setAttribute("class",this._config.autocompleteContainerClasses)}_setAutocompleteItemStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.padding="3px 5px",t.style.display="inline-block",t.style.marginRight="5px",t.style.marginBottom="5px",t.style.backgroundColor="rgb(239, 239, 239)",t.style.cursor="pointer"),null!=this._config.autocompleteItemStyles)for(const[e,i]of Object.entries(this._config.autocompleteItemStyles))t.style[e]=i}_setAutocompleteItemClass(t){null!=this._config.autocompleteItemClasses&&t.setAttribute("class",this._config.autocompleteItemClasses)}_setAutocompleteLoaderStyle(t){if(0==this._config.clearDefaultStyles&&(t.style.padding="3px 5px",t.style.display="inline-block",t.style.marginRight="5px",t.style.marginBottom="5px",t.style.backgroundColor="rgb(239, 239, 239)",t.style.color="#000000",t.style.position="absolute"),null!=this._config.autocompleteLoaderStyles)for(const[e,i]of Object.entries(this._config.autocompleteLoaderStyles))t.style[e]=i}_setAutocompleteLoaderClass(t){null!=this._config.autocompleteLoaderClasses&&t.setAttribute("class",this._config.autocompleteLoaderClasses)}_isElement(t){return t instanceof HTMLElement}_showAutocompleteLoader(){if(0==this._config.autocomplete)return!1;if(this._hideAutocompleteLoader(),""!=this._liveInputValue){const t=document.createElement("span");t.setAttribute("id",this._id+"__autocomplete-loader"),this._setAutocompleteLoaderStyle(t),this._setAutocompleteLoaderClass(t),null!=this._config.autocompleteLoaderHTML&&""!=this._config.autocompleteLoaderHTML?t.innerHTML=this._config.autocompleteLoaderHTML:t.innerHTML="Please wait...",this._autocompleteContainer.innerHTML="",this._element.append(t)}}_hideAutocompleteLoader(){if(0==this._config.autocomplete)return!1;this._element.querySelector("#"+this._id+"__autocomplete-loader")&&this._element.querySelector("#"+this._id+"__autocomplete-loader").remove()}getValues(t=!1){return t?this._values.map((t=>t.tag)):this._values}getJSONValues(t=!1){return t?JSON.stringify(this._values.map((t=>t.tag))):JSON.stringify(this._values)}getRawValues(){return this.getValues(!0).join(",")}setError(t){this._setError(t)}}}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var o=e[s]={exports:{}};return t[s](o,o.exports,i),o.exports}return i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i(138)})()));